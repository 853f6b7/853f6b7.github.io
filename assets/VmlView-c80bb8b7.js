import{T as I,V as C,E as S,_ as L,J as y,d as B,c as V,a as k}from"./EmptyState-3175e743.js";import{h as D,r as m,o as r,c as g,b as o,a as n,w as l,g as d,F as v,i as P,d as b,e as f,n as G,E as F,t as _,p as N,j as O}from"./index-30ae5fdf.js";import"./axios-4a70c6fc.js";const A={class:"container-vml"},$={class:"vml-lista-container"},z={class:"lista"},E={class:"calendario"},M=["disabled"],j={key:0,class:"pagination"},q={class:"items-pagination"},J=["src"],T={class:"dialog-footer"},U={data:()=>({user:JSON.parse(localStorage.getItem("user")),vmls:[],starDate:new Date,endDate:new Date,registros:10,pagina:1,totalPaginas:null,selects:[],selectedBusiness:[],dialogVisible:!1,imgView:null,listaClientes:[],loading:!0}),created(){this.mountGrid()},watch:{pagina(){this.mountGrid()},endDate(){this.mountGrid()}},methods:{formatData:t=>new Date(t).toLocaleString([],{dateStyle:"short"}),setPage(t){this.pagina=t},downloadAllSelected(){const t="https://portalmultilixo.blob.core.windows.net/portalmultilixo",e=y();this.selects.forEach(s=>{e.file(t+s.pathImagem,"hello world")}),e.generateAsync({type:"blob"}).then(s=>{const i=new Blob([s]);B(i,"meu.zip")})},downloadItem(t){const e="https://portalmultilixo.blob.core.windows.net/portalmultilixo"+t.pathImagem;window.open(e,"_blank")},viewItem(t){const e="https://portalmultilixo.blob.core.windows.net/portalmultilixo"+t.pathImagem;this.imgView=e,this.dialogVisible=!0},changeFilterBusiness(t){this.selectedBusiness=[t]},changeDates({start:t,end:e}){this.starDate=new Date(t),this.endDate=new Date(e)},selectItem(t,e){e?this.selects.push(t):this.selects=this.selects.filter(s=>s!=t)},setLoading(t){const e=F.service({lock:!0,text:"Carregando...",background:"rgba(0, 0, 0, 0.7)"});t||e.close(),this.selects=[]},mountGrid(){const{idGruposClientes:t,role:e}=this.user,{pagina:s,registros:i,selectedBusiness:c,__API:p,setLoading:u}=this;u(!0),V.Get(`${p}/Cliente/grupo/`+t).then(h=>{const a={vrl:0,pagina:s,registros:i,datainicial:this.starDate.toISOString(),datafinal:this.endDate.toISOString(),idgruposclientes:t,versao:2,listaclientes:h.data};c.length>0?a.listaclientes=c:e=="Admin"&&(a.listaclientes=[]),V.Post(`${p}/Vrls/periodo`,a).then(w=>{this.totalPaginas=w.data.total_registros,this.vmls=w.data.registros,u(!1)}).catch(()=>{u(!1),this.vmls=[]})})}}},H=Object.assign(U,{__name:"VmlLista",setup(t){return(e,s)=>{const i=m("el-col"),c=m("el-row"),p=m("el-pagination"),u=m("el-button"),h=m("el-dialog");return r(),g(v,null,[o(I,{title:"Ordens de servico VML"}),o(C,{changeFilterBusiness:e.changeFilterBusiness,Pesquisar:e.mountGrid,idGrupoClientes:this.idgruposclientes,background:"#F08327"},null,8,["changeFilterBusiness","Pesquisar","idGrupoClientes"]),n("div",A,[n("div",$,[n("div",z,[o(c,null,{default:l(()=>[o(i,{span:1}),o(i,{span:11},{default:l(()=>[d("Nome")]),_:1}),o(i,{span:4},{default:l(()=>[d("VML")]),_:1}),o(i,{span:4},{default:l(()=>[d("Data")]),_:1}),o(i,{span:4},{default:l(()=>[d("Ações")]),_:1})]),_:1}),(r(!0),g(v,null,P(e.vmls,a=>(r(),b(k,{selectItem:e.selectItem,idVrls:a.idVrls,actionDownload:e.downloadItem,actionView:e.viewItem,data:a},{cnpj:l(()=>[d(_(a.nomeLocal!=""?a.nomeLocal:a.nome),1)]),vml:l(()=>[d(_(a.vrl),1)]),data:l(()=>[d(_(e.formatData(a.dataBaixa)),1)]),_:2},1032,["selectItem","idVrls","actionDownload","actionView","data"]))),256)),e.vmls.length===0?(r(),b(S,{key:0,message:"Nenhum VML encontrado"})):f("",!0)]),n("div",E,[o(c,null,{default:l(()=>[o(i,{span:12},{default:l(()=>[n("button",{class:G([{"button-download":!0,"button-download-active":e.selects.length>0},"button-download"]),disabled:e.selects.length==0,onClick:s[0]||(s[0]=a=>e.downloadAllSelected())}," DOWNLOAD",10,M)]),_:1})]),_:1}),o(L,{changeDates:e.changeDates},null,8,["changeDates"])])]),e.vmls.length>0?(r(),g("div",j,[n("div",q,[o(p,{background:"",layout:"prev, pager, next",total:e.totalPaginas,modelValue:e.page,"onUpdate:modelValue":s[1]||(s[1]=a=>e.page=a),onCurrentChange:e.setPage,"page-size":e.registros},null,8,["total","modelValue","onCurrentChange","page-size"])])])):f("",!0),o(h,{modelValue:e.dialogVisible,"onUpdate:modelValue":s[3]||(s[3]=a=>e.dialogVisible=a),width:"80%","before-close":e.handleClose},{footer:l(()=>[n("span",T,[o(u,{onClick:s[2]||(s[2]=a=>e.dialogVisible=!1)},{default:l(()=>[d("Fechar")]),_:1})])]),default:l(()=>[n("img",{src:e.imgView,style:{width:"100%"}},null,8,J)]),_:1},8,["modelValue","before-close"])])],64)}}}),W=D(H,[["__scopeId","data-v-cc6e288f"]]);const Z=t=>(N("data-v-6a452edc"),t=t(),O(),t),K=Z(()=>n("div",{class:"breadcumbs"},[n("div",{class:"home"},"Home"),n("div",{class:"ordens-service-vml"},"Ordens de serviço VML")],-1)),Q={__name:"VmlView",setup(t){return(e,s)=>(r(),g("div",null,[K,n("div",null,[o(W)])]))}},x=D(Q,[["__scopeId","data-v-6a452edc"]]);export{x as default};
