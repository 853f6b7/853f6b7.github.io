import{T as S,E as k}from"./EmptyState-75312fc6.js";import{_ as L,r,o as c,m as _,w as s,b as a,x as E,a as n,u as $,z as q,p as P,j as V,c as p,F as f,l as b,s as B,i as u,d as w,q as y,e as U,E as j,t as N}from"./index-61819842.js";/* empty css                                                    */import{V as O}from"./VisualizarArquivoVml-af3c53a5.js";const I=t=>(P("data-v-f4903097"),t=t(),V(),t),R={class:"botoes-container"},z=I(()=>n("div",{class:"texto-botao"},"Visualizar",-1)),A=I(()=>n("div",{class:"texto-botao"},"Download",-1)),F={props:{actionDownload:{type:Function,default:()=>{}},actionView:{type:Function,default:()=>{}},data:{type:Object,default:{}}}},G=Object.assign(F,{__name:"DocumentoLegalItem",setup(t){return(e,o)=>{const l=r("el-col"),d=r("el-button"),m=r("el-row");return c(),_(m,null,{default:s(()=>[a(l,{span:20},{default:s(()=>[E(e.$slots,"nomearquivo",{},void 0,!0)]),_:3}),a(l,{span:4},{default:s(()=>[n("div",R,[a(d,{icon:O,onClick:o[0]||(o[0]=g=>e.$props.actionView(e.$props.data))},{default:s(()=>[z]),_:1}),a(d,{icon:$(q),onClick:o[1]||(o[1]=g=>e.$props.actionDownload(e.$props.data))},{default:s(()=>[A]),_:1},8,["icon"])])]),_:1})]),_:3})}}}),T=L(G,[["__scopeId","data-v-f4903097"]]);const H=t=>(P("data-v-65778a88"),t=t(),V(),t),J={class:"pesquisa"},K=H(()=>n("div",{class:"texto"},"Selecione uma empresa",-1)),M={style:{"margin-top":"10px"}},Q={class:"container"},W={class:"container-documentos-legais"},X={class:"documentos-legais-lista"},Y={class:"lista"},Z={key:0,class:"pagination"},x={class:"items-pagination"},ee={data:()=>({pagina:1,totalPaginas:null,registros:10,documentos:[],empresas:[],empresaSelected:""}),created(){this.fetchEmpresas()},methods:{mountGrid(){const{__API:t}=this;this.setLoading(!0),y.Post(`${t}/DocumentosPortal/lista`,{pagina:this.pagina,registros:this.registros,idEmpresasPortal:this.empresaSelected}).then(e=>{this.documentos=e.data.registros,this.totalPaginas=e.data.total_registros}).catch(e=>{e.response.status==404&&(this.documentos=[],this.totalPaginas=null),console.error(e)}).finally(()=>{this.setLoading(!1)})},Pesquisar(){this.mountGrid()},fetchEmpresas(){const{__API:t}=this;y.Get(`${t}/EmpresasPortal/lista`).then(e=>{console.log(e),this.empresas=e.data})},setPage(t){this.selects=[],this.pagina=t,this.mountGrid()},apiCall(t,e){const{__BLOBAPI:o}=this;this.setLoading(!0),U.get(`${o}${t.path}`,{responseType:"blob"}).then(e).catch(l=>{console.error(l)}).finally(()=>{this.setLoading(!1)})},viewItem(t){this.apiCall(t,e=>{var o=new Blob([e.data],{type:"application/pdf"}),l=URL.createObjectURL(o);window.open(l)})},downloadItem(t){this.apiCall(t,e=>{var o=new Blob([e.data],{type:"application/pdf"}),l=URL.createObjectURL(o);const d=document.createElement("a");d.href=l,d.download=t.nome,d.click()})},setLoading(t){const e=j.service({lock:!0,text:"Carregando...",background:"rgba(0, 0, 0, 0.7)"});t||e.close()}}},te=Object.assign(ee,{__name:"DocumentosLegais",setup(t){return(e,o)=>{const l=r("el-option"),d=r("el-select"),m=r("el-col-2"),g=r("el-button"),h=r("el-col"),v=r("el-row"),D=r("el-pagination");return c(),p(f,null,[a(S,{title:"Documentos legais"}),n("div",J,[K,n("div",M,[a(v,null,{default:s(()=>[n("div",Q,[a(m,null,{default:s(()=>[a(d,{modelValue:e.empresaSelected,"onUpdate:modelValue":o[0]||(o[0]=i=>e.empresaSelected=i),placeholder:"Empresa",style:{width:"300px"},filterable:"",clearable:""},{default:s(()=>[(c(!0),p(f,null,b(e.empresas,(i,C)=>(c(),_(l,{key:C,label:`${i.nome}`,value:i.idEmpresasPortal},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(h,{span:2,class:"botao-container"},{default:s(()=>[n("div",null,[a(g,{type:"primary",class:"botao",onClick:o[1]||(o[1]=i=>e.Pesquisar()),disabled:e.empresaSelected=="",icon:$(B),color:e.colorButton},{default:s(()=>[u("Pesquisa")]),_:1},8,["disabled","icon","color"])])]),_:1})])]),_:1})])]),n("div",W,[n("div",X,[n("div",Y,[a(v,{class:"lista-header"},{default:s(()=>[a(h,{span:20},{default:s(()=>[u("Nome do arquivo")]),_:1}),a(h,{span:4},{default:s(()=>[u("Ações")]),_:1})]),_:1}),(c(!0),p(f,null,b(e.documentos,i=>(c(),_(T,{actionDownload:e.downloadItem,actionView:e.viewItem,data:i},{nomearquivo:s(()=>[u(N(i.nome),1)]),_:2},1032,["actionDownload","actionView","data"]))),256)),e.documentos.length===0?(c(),_(k,{key:0,message:"Nenhum documento encontrado"})):w("",!0)])]),e.documentos.length>0?(c(),p("div",Z,[n("div",x,[a(D,{clearable:"",small:"",background:"",layout:"prev, pager, next",total:e.totalPaginas,modelValue:e.page,"onUpdate:modelValue":o[2]||(o[2]=i=>e.page=i),onCurrentChange:e.setPage,"page-size":e.registros},null,8,["total","modelValue","onCurrentChange","page-size"])])])):w("",!0)])],64)}}}),le=L(te,[["__scopeId","data-v-65778a88"]]);export{le as D};
