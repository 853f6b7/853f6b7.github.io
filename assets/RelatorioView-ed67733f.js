import{V as $,T as y,a as P,E as F,c as R}from"./VisualizarArquivoVml-971b1aa5.js";import{_ as v,r as p,o as u,i as f,w as s,b as a,j as m,a as r,c as h,f as l,F as b,k as B,d as V,E as D,t as g,p as k,g as S}from"./index-a840b029.js";import{a as G}from"./axios-4a70c6fc.js";const L={data:()=>({selected:!1}),props:{selectItem:{type:Function,default:()=>{}},idVrls:{type:Number},actionDownload:{type:Function,default:()=>{}},actionView:{type:Function,default:()=>{}},data:{type:Array,default:[]}},watch:{selected(){this.$props.selectItem(this.$props.data,this.selected)}}},N=Object.assign(L,{__name:"RelatorioItem",setup(t){return(e,n)=>{const o=p("el-col"),d=p("el-button"),c=p("el-row");return u(),f(c,null,{default:s(()=>[a(o,{span:3},{default:s(()=>[m(e.$slots,"codigocliente",{class:"nome"},void 0,!0)]),_:3}),a(o,{span:7},{default:s(()=>[m(e.$slots,"nome",{class:"nome"},void 0,!0)]),_:3}),a(o,{span:7},{default:s(()=>[m(e.$slots,"descricaoDocumento",{class:"nome"},void 0,!0)]),_:3}),a(o,{span:5},{default:s(()=>[m(e.$slots,"periodo",{},void 0,!0)]),_:3}),a(o,{span:1},{default:s(()=>[r("div",null,[a(d,{icon:$,onClick:n[0]||(n[0]=i=>e.$props.actionView(e.$props.data))})])]),_:1})]),_:3})}}}),M=v(N,[["__scopeId","data-v-777c9c82"]]);const j={class:"container-vml"},O={class:"vml-lista-container"},E={class:"lista"},q={key:0,class:"pagination"},A={class:"items-pagination"},T={data:()=>({user:JSON.parse(localStorage.getItem("user")),vmls:[],registros:10,pagina:1,totalPaginas:null,selectedBusiness:[],loading:!0,idgruposclientes:null,periodoInicial:new Date,periodoFinal:new Date}),created(){this.mountGrid()},watch:{pagina(){this.mountGrid()},endDate(){this.mountGrid()}},methods:{formatData:t=>`${t.substr(4,6)} /  ${t.substr(0,4)}`,setPage(t){this.pagina=t},viewItem(t){const e="https://portalmultilixo.blob.core.windows.net/portalmultilixo"+t.pathImagem,n={responseType:"blob"};G.get(e,n).then(o=>{var d=new Blob([o.data],{type:"application/pdf"}),c=URL.createObjectURL(d);window.open(c)})},changeFilterBusiness(t){this.selectedBusiness=[t]},changePeriodoControl({start:t,end:e}){this.periodoInicial=t,this.periodoFinal=e,console.log(t),console.log(e)},setLoading(t){const e=D.service({lock:!0,text:"Carregando...",background:"rgba(0, 0, 0, 0.7)"});t||e.close()},mountGrid(){this.user;const{selectedBusiness:t,__API:e,setLoading:n,periodoInicial:o,periodoFinal:d}=this,c=("0"+parseInt(o.getMonth()+1)).slice(-2),i=("0"+parseInt(d.getMonth()+1)).slice(-2),I=`${o.getFullYear()}${c}`,C=`${d.getFullYear()}${i}`;var _={periodoinicial:I,periodofinal:C};t.length>0?_=Object.assign(_,{idgruposclientes:t.idGrupoClientes,idclientes:t.idClientes}):_=Object.assign(_,{idgruposclientes:47,idclientes:13}),n(!0),R.Post(`${e}/Medicao/periodo`,_).then(w=>{this.totalPaginas=w.data.total_registros,this.vmls=w.data,n(!1)}).catch(()=>{n(!1),this.vmls=[]})}}},U=Object.assign(T,{__name:"RelatorioMedicao",setup(t){return(e,n)=>{const o=p("el-col"),d=p("el-row"),c=p("el-pagination");return u(),h(b,null,[a(y,{title:"Relatórios"}),a(P,{changeFilterBusiness:e.changeFilterBusiness,Pesquisar:e.mountGrid,idGrupoClientes:e.idgruposclientes,background:"#543976",showPeriodoControl:!0,changePeriodoControl:e.changePeriodoControl},null,8,["changeFilterBusiness","Pesquisar","idGrupoClientes","changePeriodoControl"]),r("div",j,[r("div",O,[r("div",E,[a(d,null,{default:s(()=>[a(o,{span:3},{default:s(()=>[l("Cod. Cliente")]),_:1}),a(o,{span:7},{default:s(()=>[l("Nome")]),_:1}),a(o,{span:7},{default:s(()=>[l("Descricao Documento")]),_:1}),a(o,{span:5},{default:s(()=>[l("Periodo")]),_:1}),a(o,{span:1},{default:s(()=>[l("Ações")]),_:1})]),_:1}),(u(!0),h(b,null,B(e.vmls,i=>(u(),f(M,{idVrls:i.idVrls,actionView:e.viewItem,data:i},{codigocliente:s(()=>[l(g(i.codigoCliente),1)]),nome:s(()=>[l(g(i.nome),1)]),descricaoDocumento:s(()=>[l(g(i.descricaoDocumento),1)]),periodo:s(()=>[l(g(e.formatData(i.periodo)),1)]),_:2},1032,["idVrls","actionView","data"]))),256)),e.vmls.length===0?(u(),f(F,{key:0,message:"Nenhum VML encontrado"})):V("",!0)])]),e.vmls.length>0?(u(),h("div",q,[r("div",A,[a(c,{background:"",layout:"prev, pager, next",total:e.totalPaginas,modelValue:e.page,"onUpdate:modelValue":n[0]||(n[0]=i=>e.page=i),onCurrentChange:e.setPage,"page-size":e.registros},null,8,["total","modelValue","onCurrentChange","page-size"])])])):V("",!0)])],64)}}}),z=v(U,[["__scopeId","data-v-bf43ac41"]]);const Y=t=>(k("data-v-739a9a0f"),t=t(),S(),t),H=Y(()=>r("div",{class:"breadcumbs"},[r("div",{class:"home"},"Home"),r("div",{class:"ordens-service-vml"},"Relatórios")],-1)),J={__name:"RelatorioView",setup(t){return(e,n)=>(u(),h("div",null,[H,r("div",null,[a(z)])]))}},X=v(J,[["__scopeId","data-v-739a9a0f"]]);export{X as default};
